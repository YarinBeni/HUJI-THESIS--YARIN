The Central Role of the Propensity Score in Observational Studies for Causal
Effects
Paul R. Rosenbaum; Donald B. Rubin
Biometrika, Vol. 70, No. 1. (Apr., 1983), pp. 41-55.
Stable URL:
http://links.jstor.org/sici?sici=0006-3444%28198304%2970%3A1%3C41%3ATCROTP%3E2.0.CO%3B2-Q
Biometrika is currently published by Biometrika Trust.
Your use of the JSTOR archive indicates your acceptance of JSTOR's Terms and Conditions of Use, available at
http://www.jstor.org/about/terms.html. JSTOR's Terms and Conditions of Use provides, in part, that unless you have obtained
prior permission, you may not download an entire issue of a journal or multiple copies of articles, and you may use content in
the JSTOR archive only for your personal, non-commercial use.
Please contact the publisher regarding any further use of this work. Publisher contact information may be obtained at
http://www.jstor.org/journals/bio.html.
Each copy of any part of a JSTOR transmission must contain the same copyright notice that appears on the screen or printed
page of such transmission.
JSTOR is an independent not-for-profit organization dedicated to and preserving a digital archive of scholarly journals. For
more information regarding JSTOR, please contact support@jstor.org.
http://www.jstor.org
Wed Apr 25 23:15:44 2007
Biometrika (1983), 70, 1, pp. 41-55
Printed in Great Britain
41
The central role of the propensity score in observational
studies for causal effects
BY PAUL R. ROSENBAUM
Departments of Statistics and Human Oncology, University of Wisconsin, Madison,
Wisconsin, U.S.A.
AND DONALD B. RUBIN
University of Chicago, Chicago, Illinois, U.S.А.
SUMMARY
The propensity score is the conditional probability of assignment to a particular
treatment given a vector of observed covariates. Both large and small sample theory
show that adjustment for the scalar propensity score is sufficient to remove bias due to
all observed covariates. Applications include: (i) matched sampling on the univariate
propensity score, which is a generalization of discriminant matching, (ii) multivariate
adjustment by subclassification on the propensity score where the same subclasses are
used to estimate treatment effects for all outcome variables and in all subpopulations,
and (iii) visual representation of multivariate covariance adjustment by a twodimensional plot.
Some key words: Covariance adjustment; Direct adjustment; Discriminant matching; Matched sampling;
Nonrandomized study; Standardization; Stratification; Subelassification.
1. DEFINITIONS
1.1. The structure of studies for causal effects
Inferences about the effects of treatments involve speculations about the effect one
treatment would have had on a unit which, in fact, received some other treatment. We
consider the case of two treatments, numbered I and 0. In principle, the ith of the N
units under study has both a response , that would have resulted if it had received
treatment 1, and a response roi that would have resulted if it had received treatment 0.
In this formulation, causal effects are comparisons of and Yor, for example 1-Tor or
oi. Since each unit receives only one treatment, either or roi is observed, but not
both, so comparisons of *1 and roi imply some degree of speculation. In a sense,
estimating the causal effects of treatments is a missing data problem, since either 1, or
roi is missing.
This formulation is that used in the literature of experimental design, for example, in
the books by Fisher (1951) and Kempthorne (1952), and follows the development by
Rubin (1974, 1977, 1978, 1980a); Hamilton (1979) adopts a similar approach. The
structure would not be adequate when, for example, the response of unit i to treatment
depends on the treatment given to unit j, as could happen if they compete for resources.
The assumption that there is a unique value r corresponding to unit i and treatment t
has been called the stable unit-treatment value assumption (Rubin, 1980a), and will be
42 P. R. ROSENBAUM AND D. B. RUBIN
made here. For discussion of some possible violations of this assumption, see Cox (1958,
Chapter 2) or Rubin (1978, §2-3).
In this paper, the N units in the study are viewed as a simple random sample from
some population, and the quantity to be estimated is the average treatment effect,
defined as
E(Y)-E(ro),
where E(.) denotes expectation in the population.
(1-1)
Let 2 = 1 if unit i is assigned to the experimental treatment, and z₁ = 0 if unit i is
assigned to the control treatment. Let x, be a vector of observed pretreatment
measurements or covariates for the ith unit; all of the measurements in x are made prior
to treatment assignment, but x may not include all covariates used to make treatment
assignments. It is assumed that the numbering of units is done at random, so that the
index i contains no information; observed information about unit i is contained in x.
Throughout, we ignore measure theoretic details.
1.2. Balancing scores and the propensity score
In randomized experiments, the results in the two treatment groups may often be
directly compared because their units are likely to be similar, whereas in nonrandomized
experiments, such direct comparisons may be misleading because the units exposed to
one treatment generally differ systematically from the units exposed to the other
treatment. Balancing scores, defined here, can be used to group treated and control units
80 that direct comparisons are more meaningful.
A balancing score, b(x), is a function of the observed covariates x such that the
conditional distribution of x given b(x) is the same for treated (2 = 1) and control (2 = 0)
units; that is, in Dawid's (1979) notation,
x T z b(x).
The most trivial balancing score is b(x) = 2. More interesting balancing scores are manyone functions of x. In §2 we identify all functions ofx that are balancing scores and
identify the coarsest funetion of x that is a balancing score, namely the propensity score.
We also show that easily obtained estimates of balancing scores behave like balancing
scores. Also, we show that if treatment assignment is strongly ignorable given x, as
defined in § 1-3, then the difference between treatment and control means at each value of
a balancing score is an unbiased estimate of the treatment effect at that value, and
consequently pair matching, subclassification and covariance adjustment on a balancing
score can produce unbiased estimates of the average treatment effect (1-1). Moreover in
$3 we see that common methods of multivariate adjustment in observational studies,
including covariance adjustment for x and diseriminant matching (Cochran & Rubin,
1973), implicitly adjust for an estimated scalar balancing score.
In order to motivate formally adjustment for a balancing score, we must consider the
sampling distribution of treatment assignments. Let the conditional probability of
assignment to treatment one, given the covariates, be denoted by
where we assume
e(x) = pr (z=1|x),
pr (21,....2|21,... ) = iП е(х) *"{1-e(x)}11
(1-2)
Propensity score in observational studies 43
Although this strict independence assumption is not essential, it simplifies notation and
discussion. The function e(x) is called the propensity score, that is, the propensity
towards exposure to treatment 1 given the observed covariates x. In §2, e(x) is shown to
be the coarsest balancing score.
1-3. Strongly ignorable treatment assignment
Randomized and nonrandomized trials differ in two distinct ways because in
randomized experiments z; has a distribution determined by a specified random
mechanism. First, in a randomized trial, the propensity score is a known function so that
there exists one accepted specification for e(x). In a nonrandomized experiment, the
propensity score function is almost always unknown so that there is not one accepted
specification for e(x); however, e(x) may be estimated from observed data, perhaps using a
model such as a logit model. To a Bayesian, estimates of these probabilities are posterior
predictive probabilities of assignment to treatment 1 for a unit with vector x of
covariates.
The second way randomized trials differ from nonrandomized trials is that, with
properly collected data in a randomized trial, æ is known to include all covariates that
are both used to assign treatments and possibly related to the response (r1,*o). More
formally, in a randomized trial, treatment assignment z and response (r1, o) are known
to be conditionally independent given x,
(¥150) zx.
This condition is usually not known to hold in a nonrandomized experiment. Moreover,
in a randomized experiment, every unit in the population has a chance of receiving each
treatment. Generally, we shall say treatment assignment is strongly ignorable given a
vector of covariates v if
(1, a) z v, O< pr(z = 1 v) < 1 (1-3)
for all v. For brevity, when treatment assignment is strongly ignorable given the
observed covariates 2, that is, when (1-3) holds with v = x, we shall say simply that
treatment assignment is strongly ignorable. If treatment assignment is strongly
ignorable, then it is ignorable in Rubin's (1978) sense, but the converse is not true.
2. THEORY
2.1. Outline
Section 2 presents five theorems whose conclusions may be summarized as follows.
(i) The propensity score is a balancing score.
(ii) Any score that is 'finer' than the propensity score is a balancing score; moreover,
is the finest balancing score and the propensity score is the coarsest.
(iii) If treatment assignment is strongly ignorable given x, then it is strongly ignorable
given any balancing score.
(iv) At any value of a balancing score, the difference between the treatment and
control means is an unbiased estimate of the average treatment effect at that
value of the balancing score if treatment assignment is strongly ignorable.
Consequently, with strongly ignorable treatment assignment, pair matching on a
44 P. R. ROSENBAUM AND D. B. RUBIN
balancing score, subelassification on a balancing score and covariance adjustment
on a balancing score can all produce unbiased estimates of treatment effects.
(v) Using sample estimates of balancing scores can produce sample balance on x.
2.2. Large-sample theory
The results in this section treat e(x) as known, and are therefore applicable to large
samples.
THEOREM 1. Treatment assignment and the observed covariates are conditionally independent given the propensity score, that is
x z|e(x).
The above theorem is a special case of Theorem 2. Cochran & Rubin (1973) proved
Theorem I in the particular case of multivariate normal covariates x; the result holds
regardless of the distribution of x.
THEOREM 2. Let b(x) be a function of x. Then b(x) is a balancing score, that is,
x 2 b(x), (2-1)
if and only if b(x) is finer than e(x) in the sense that e(x) = f{b(x)} for some function f.
Proof. First suppose b(x) is finer than e(x). Since e(x) = pr(2 = 1x), to show b(x) is a
balancing score it is sufficient to show
pr {2 = 11b(x)} = e(x).
Now by the definition of e(x),
pr {2 = 1[b(x)} = E{e(x)| b(x)}.
But since b(x) is finer than e(x),
E{e(x)[b(x)} = e(x),
(2.2)
as required, so that b(x) is a balancing score.
Now, for the converse, suppose b(x) is a balancing score, but that b(x) is not finer than
e(x), so that there exists x1 and x2 such that e(x1) e(x2) but b(x₁) = b(x2). But then, by
the definition of e(.), pr (2 = 1|x₁) +pr(2 = 1|x2), s0 that z and x are not conditionally
independent given b(x), and thus b(x) is not a balancing score. Therefore, to be a
balancing score, b(x) must be finer than e(x).
Theorem 1 implies that if a subeclass of units or a matched treatment-control pair is
homogeneous in e(x), then the treated and control units in that subclass or matched pair
will have the same distribution of x. Theorem 2 implies that if subclasses or matched
treated-control pairs are homogeneous in both e(x) and certain chosen components of x,
it is still reasonable to expect balance on the other components of x within these refined
subclasses or matched pairs. The practical importance of Theorem 2 beyond Theorem 1
arises because it is sometimes advantageous to subclassify or match not only for e(x) but
for other functions of x as well; in particular, such a refined procedure may be used to
obtain estimates of the average treatment effect in subpopulations defined by components of x, for example males, females.
Theorem 3 is the key result for showing that if treatment assignment is strongly
Propensity score in observational studies 45
ignorable, then adjustment for a balancing score b(x) is sufficient to produce unbiased
estimates of the average treatment effect (1-1).
THEOREM 3. If treatment assignment is strongly ignorable given x, then it is strongly
ignorable given any balancing score b(x); that is,
2ـ (10)
and
for all x imply
0 < pr (2 = 1|x) < 1
(71, o) 2[b(x)
and
for all b(x).
0< pr {2 = 1[b(x)} <1
Proof. The inequality given b(x) follows immediately from the inequality given x.
Consequently, it is sufficent to show that
pr {z = 11, ro, b(x)} = pr {2 = 1|b(x)},
which by Theorem 2, equation (2·2), is equivalent to showing that
Now
pr {2 = 1|r₁, o, b(x)} = e(x).
pr{2=11, ro,b(x)} = E{pr (z = 1[71, 70, X) 71, ra, b(x)},
which by assumption equals E{pr(2 = 1|x}|r1,ro, b(x}}, which by definition equals
E{e(x) 1,r0, b(x)}, which, since b(x} is finer than e(x), equals e(x) as required.
Theorem 3 also can be proved using Lemmas 4.2(i) and 4.3 of Dawid (1979).
We are now ready to relate balancing scores and ignorable treatment assignment
the estimation of treatment effects.
to
The response r, to treatment t is observed only if the unit receives treatment t, that is
if 2 = t. Thus, if a randomly selected treated unit, z = 1, is compared to a randomly
selected control unit, z = 0, the expected difference in response is
E(r12 = 1)- E( 2 = 0). (2-3)
Expression (2·3) does not equal (1.1) in general because the available samples are not
from the marginal distribution of r, but rather from the conditional distribution of r,
given z = t.
Suppose a specific value of the vector of covariates x is randomly sampled from the
entire population of units, that is, both treated and control units together, and then a
treated unit and a control unit are found both having this value for the vector of
covariates. In this two-step sampling process, the expected difference in response is
Ex{E(rx, 2 = 1)-E(ro|x, z = 0)}, (2-4)
where E denotes expectation with respect to the distribution of x in the entire
population of units. If treatment assignment is strongly ignorable, that is if (1-3) holds
with v = x, then (2-4) equals
E(E(rx)- E(ro|x}},
which does equal the average treatment effect (1.1).
46 P. R. ROSENBAUM AND D. B. RUBIN
Now suppose a value of a balancing score b(x)is sampled from the entire population of
units and then a treated unit and a control unit are sampled from all units having this
value of b(x), but perhaps different values of æ. Given strongly ignorable treatment
assignment, it follows from Theorem 3 that
E{r1 b(2), 2 = 1}-E{ro|b(x), 2 = 0} = E{r₁[b(x)}-E{ro|b(x)}
from which it follows that
Eb(x) [E(1 b(x), 2 = 1}-E{ro[b(x), 2 = 0}] = Eb(x) [E{r1[b(x)}-E{ro[b(x)}]
= E(r-ro), (2-5)
where El) denotes expectation with respect to the distribution of b(x) in the entire
population. In words, under strongly ignorable treatment assignment, units with the
same value of the balancing score b(x) but different treatments can act as controls for
each other, in the sense that the expected difference in their responses equals the average
treatment effect.
The above argument has established the following theorem and corollaries.
THEOREM 4. Suppose treatment assignment is strongly ignorable and b(x) is a balancing
score. Then the expected difference in observed responses to the two treatments at b(x) is equal
to the average treatment effect at b(x), that is,
E{r₁ b(x), 2 = 1}-E{ro b(x), 2 = 0} = B{r₁-0|b(x)}.
COROLLARY 41. Pair matching on balancing scores. Suppose treatment assignment is
strongly ignorable. Further suppose that a value of a balancing score b(x) is randomly
sampled from the population of units, and then one treated, 2 = 1, unit and one control, 2 =0,
unit are sampled with this value of b(x). Then the expected difference in response to the two
treatments for the units in the matched pair equals the average treatment effect at b(x).
Moreover, the mean of matched pair differences obtained by this two-step sampling process is
unbiased for the average treatment effect (1-1).
COROLLARY 4.2. Subclassification on balancing scores. Suppose treatment assignment is
strongly ignorable. Suppose further that a group of units is sampled using b(x) such that: (i)
b(x) is constant for all units in the group, and (ii) at least one unit in the group received each
treatment. Then, for these units, the expected difference in treatment means equals the average
treatment effect at that value of b(x). Moreover, the weighted average of such differences, that
is, the directly adjusted difference, is unbiased for the treatment effect (1.1), when the weights
equal the fraction of the population at b(x).
COROLLARY 4·3. Covarianceadjustment on balancing scores.Suppose treatment assignment
is strongly ignorable, so that in particular, E{r,|z = t,b(x)} = E{r,|b(x)} for balancing score
b(x). Further suppose that the conditional expectation of r, given b(x) is linear:
Then the estimator
E{r,2= t, b(x)} = a4 +Bb(x) (t = 0,1).
(Q-0)+(B-Bo) b(x)
is conditionally unbiased given b(x) (i = 1,..., n) for the treatment effect at b(x), namely
Propensity score in observational studies 47
B{r-ro|b(x)}, if &, and ẞ, are conditionally unbiased estimators of a, and B,, such as least
squares estimators. Moreover,
(-2) + (B-Во)б,
where b = nΣb(x), is unbiased for the average treatment effect (1·1) if the units in the
study are a simple random sample from the population.
2.3. Some small-sample theory
Usually the propensity scores e(x) must be estimated from available data,
(2 x) (i = 1,..., N). Define the sample conditional proportion prop(A |B) as the proportion of those vectors (2, x) satisfying condition B that also satisfy condition A,
leaving prop (A|B) undefined if no vector satisfies condition B. For example,
prop {2 = 1|x = (1,0)} is the proportion of the N units with z = 1 among all units with
x = (1, 0). Estimate e(x) by ê(a) = prop (z = 1|x = a). If ê(a) = 0 or 1 then all units with
x = a received the same treatment. Theorem 5, which parallels Theorem 1, shows that at
all intermediate values of ê(a), that is for 0 < ê(a) < 1, there is sample balance. Of course,
intermediate values of ê(x) will exist only when x takes on relatively few values.
THEOREM 5. Suppose 0 < ê(a) < 1. Then
prop {z = 0,x = a[ê(x) = ê(a)} = prop {2 = 0|(x) = ê(x)} prop {x = a|ê(z) = ê(a)}.
(2.6)
An analogous theorem about sample balance parallels Theorem 2, and the proofs
parallel the corresponding proofs of Theorems 1 and 2 because proportions follow
essentially the same axioms as probabilities.
COROLLARY 5.1. Suppose the N units are a random sample from an infinite population,
and suppose x takes on only finitely many values in the population and at each such value
0 < e(x) < 1. Then with probability 1 as N, subclassification on ê(x) produces sample
balance, that is, (2-6) holds.
In practice, except when x takes on only a few values, ê(a) will be either zero or one for
most values of a. Consequently, in order to estimate propensity scores, some modelling
will be required.
The propensity score can often be modelled using an appropriate logit model (Cox,
1970) or discriminant score.
Clearly,
e(x) = pr (2 = 1|x) = pr (z = 1) pr (x 2 = 1)
pr (2 = 1) pr (x z = 1)+pr (2 = 0) pr (2|2 = 0)
Elementary manipulations establish the following facts.
(i) If pr (x|z = t) = N (42) then e(x) is a monotone function of the linear discriminant xQ-1(μ₁-42). Therefore, matching on e(x) includes discriminant matching
(Cochran & Rubin, 1973; Rubin 1976a, b; 1979; 1980b) as a special case. Some related
results appear in §3-2.
(ii) If pr (x| 2 = t) is a polynomial exponential family distribution, i.e. if
pr (x|z = t) = h(x) exp {P, (x)},
48 P. R. ROSENBAUM AND D. B. RUBIN
where P(x) is a polynomial in x of degree k, say, then e(x) obeys a polynomial logit model
log e(x)
1-e(x)
pr (z = 1)
= log +P (x)-Po(x) 1-pr (2 = 1)
pr (2 = 1)
= log +Q(x), 1-pr (2 = 1)
where Q(x) is a degree k polynomial in x. This polynomial exponential family includes the
linear exponential family resulting in a linear logit model for e(x), the quadratic
exponential family described by Dempster (1971), and the binary data model described
by Cox (1972). Related discussion is given by Dawid (1976).
3. THREE APPLICATIONS OF PROPENSITY SCORES TO OBSERVATIONAL STUDIES
3-1. Techniques for adjustment in observational studies
The general results we have presented suggest that, in practice, adjustment for the
propensity score should be an important component of the analysis of observational
studies because evidence of residual bias in the propensity score is evidence of potential
bias in estimated treatment effects. We conclude with three examples of how propensity
scores can be explicitly used to adjust for confounding variables in observational studies.
The examples involve three standard techniques for adjustment in observational studies
(Cochran, 1965; Rubin, 1983), namely, matched sampling, subclassification, and
covariance adjustment, that is, the three methods addressed by Corollaries 4-1, 42 and
4.3.
3.2. Use of propensity scores to construct matched samples from treatment groups
Matching is a method of sampling from a large reservoir of potential controls to
produce a control group of modest size in which the distribution of covariates is similar
to the distribution in the treated group. Some sampling of a large control reservoir is
often required to reduce costs associated with measuring the response, for example, costs
associated with obtaining extensive follow-up data on patients in clinical studies (Rubin,
1973a; Cohn et al., 1981).
Although there exist model-based alternatives to matched sampling, e.g. covariance
adjustment on random samples, there are several reasons why matching is appealing.
(I) Matched treated and control pairs allow relatively unsophisticated researchers to
appreciate immediately the equivalence of treatment and control groups, and to perform
simple matched pair analyses which adjust for confounding variables. This issue is
discussed in greater detail below in §33 on balanced subelassification.
(II) Even if the model underlying a statistical adjustment is correct, the variance of
the estimate of the average treatment effect (1.1) will be lower in matched samples than
in random samples since the distributions of x in treated and control groups are more
similar in matched than in random samples. To verify this reduced variance, inspect the
formula for the variance of the covariance adjusted estimate (Snedecor & Cochran, 1980,
p. 368, formula 18.2.3), and note that the variance decreases as the difference between
treatment and control means on x decreases.
(III) Model-based adjustment on matched samples is usually more robust to
Propensity score in observational studies 49
departures from the assumed form of the underlying model than model-based adjustment on random samples (Rubin, 1973b, 1979), primarily because of reduced reliance on
the model's extrapolations.
(IV) In studies with limited resources but large control reservoirs and many
confounding variables, the confounding variables can often be controlled by multivariate matching, but the small-sample sizes in the final groups do not allow control of
all variables by model-based methods.
Ideally, treated and control units would be exactly matched on all covariates x, so
that the sample distributions of x in the two groups would be identical. Theorem 2 shows
that it is sufficient to match exactly on any balancing score b(x) to obtain the same
probability distributions of x for treated and control units in matched samples. Moreover,
Corollary 41 shows that if treatment assignment is strongly ignorable, exact matching
on a balancing score leads to an unbiased estimate of the average treatment effect.
Unfortunately, exact matches even on a scalar balancing score are often impossible to
obtain, so methods which seek approximate matches must be used. We now study
properties of some matching methods based on the propensity score.
A multivariate matching method is said to be equal per cent bias reducing if the bias in
each coordinate of æ is reduced by the same percentage (Rubin, 1976a, b). Matching
methods which are not equal per cent bias reducing have the potentially undesirable
property that they increase the bias for some linear functions of x. If matched sampling
is performed before the response (r1,ro) can be measured, and if all that is suspected
about the relation between (r1, ro) and x is that it is approximately linear, then matching
methods which are equal per cent bias reducing are reasonable in that they lead to
differences in mean response in matched samples that should be less biased than in
random samples.
The initial bias in x is
B= E(x 2 = 1)- E(x|z = 0). (3-1)
Let us suppose that we have a random sample of treated units and a large reservoir of
randomly sampled control units, and suppose each treated unit is matched with a
control unit from the reservoir. Then the expected bias in x in matched samples is
B= E(x|2 = 1) -- E (|2 = 0), (3.2)
where the subscript m indicates the distribution in matehed samples. In general, from
Theorem 2, B is a null vector if exact matches on a balancing score have been obtained.
If B = yB for some scalar y, with 0<y<1, then the matching method is equal per cent
bias reducing: the bias in each coordinate of is reduced by 100(1-p)%. If the method is
not equal per cent bias reducing, then there exists a vector w such that wB> wB, so
that matching has increased the bias for some linear function of a.
In $23 we observed that discriminant matching is equivalent to matching on the
propensity score if the covariates x have a multivariate normal distribution. Assuming
multivariate normality, Rubin (1976a) showed that matching on the population or
sample discriminant is equal per cent bias reducing. We now show that matching on the
population propensity score is equal per cent bias reducing under weaker distributional
assumptions. It is assumed that the matching algorithm matches each treated, 2 = 1,
unit with a control, z = 0, unit drawn from a reservoir of control units on the basis of a
balancing score, for example, using nearest available matching on a scalar balancing
score.
50 P. R. ROSENBAUM AND D. B. RUBIN
THEOREM 6. Let b = b(x) be a balancing score. For any matching method that uses b alone to
match each treated unit, 2 = 1, with a control unit, z = 0, the reduction in bias is
B-B = JE(x|b) {prm(b|2= 0)-pr (b|2 = 0)}db, (3-3)
where prm (b12 = 0) denotes the distribution of b in matched samples from the control group.
Proof. From (3-1) and (3.2) we have
B-B={m (x2 = 0, b) pr (b2 =0)-E(x2=0, b) pr (b12 = 0)} db. (3-4)
For any matching method satisfying the condition of the theorem,
(22 = 0, b} = E(x2 = 0, 0) (3-5)
because any matching method using b alone to match units alters the marginal
distribution of b in the control group, 2 = 0, but does not alter the conditional
distribution of x given b in the control group. However, by Theorem 2,
E(x|z = 0, b) = E(x|b).
Substitution of (3.5) and (3-6) into equation (3·4) yields the result (3-3).
(3.6)
COROLLARY 6·1. If E(x|b) = α+Bf (b) for some vectors a and ẞ and some scalar-valued
function f(.), then matching on b alone is equal per cent bias reducing.
Proof. The per cent reduction in bias for the ith coordinate of x is, from (3-3)
Bi[Em{f(b)|2 = 0} - E{f(b)|z = 0}1 100 B, [E{f (b)|2 = 1}-E{f(b)] z = 0}1
which is independent of i, as required.
The following corollary shows that if subpopulations are defined using x so that some
function d(x) is constant within each subpopulation, then propensity matching within
subpopulations is equal per cent bias reducing in each subpopulation.
COROLLARY 6.2. Let d = d(x) be some function ofx. If E(x |b, d) = &a+ Bafa (b) for vectors
a Ba, and some scalar-valued functions fa(.), then matching on b alone at each value of d is
equal per cent bias reducing at each value of d, that is,
for scalar Yd
E(x|d,z = 1) - E (x|d, 2 = 0) = ya {E(x d, z=1)-E(x|d, z = 0)}
Proof. Apply Theorem 6 and Corollary 6·1 within subpopulations.
Rubin's (1979) simulation study examines the small-sample properties of discriminant
matching in the case of normal covariates with possibly different covariances in the
treatment groups. Thus, the study includes situations where the true propensity score is
a quadratic function of x but the discriminant score is a linear function of x. Table 1
presents previously unpublished results from this study for situations in which the
propensity score is a monotone function of the linear discriminant, so that propensity
matching and discriminant matching are effectively the same. The covariates x are
Propensity score in observational studies 51
Table 1. Per cent reduction in bias due to matched sampling based on the sample and
population propensity scores
Ratio of size
control reservoir Initial bias along
to size of treatment Type of standardized discriminant
group score 0-25 0.50 0.75 1-00
2 Sample 92 85 77 67
Population 92 87 78 69
3 Sample 101 96 91 83
Population 96 95 91 84
4 Sample 97 98 95 90
Population 98 97 94 89
Assuming bivariate normal covariates with common covariance matrix, parallel linear response surfaces,
sample size of 50 in treated and control groups. Estimated per cent reduction in bias from Rubin's (1979)
simulation study. The largest estimated standard error for this table is less than 0-03.
bivariate normal with common covariance matrix. In the simulation, 50 treated units
are matched using nearest available matching (Cochran & Rubin, 1973) on the sample
discriminant with 50 control units drawn from a reservoir of 50R potential control units,
for R = 2,3,4; details are given by Rubin (1979).
Assuming parallel linear response surfaces, Table I shows that even in the absence of
additional adjustments, propensity, i.e. discriminant, matching alone can remove most
of the initial bias if the reservoir is relatively large. Moreover, Table 1 shows that the
population and sample propensity scores are approximately equally effective in removing bias, so that no substantial loss is incurred by having to estimate the propensity
score. It should be noted that the conditions underlying Table 1 differ from the
conditions underlying Theorem I because nearest available matching with imperfect
matches provides only a partial adjustment for the propensity score.
Propensity matching should prove especially effective relative to Mahalanobis metric
matching (Cochran & Rubin, 1973; Rubin, 1976a, b; 1979; 1980b) in situations where
markedly nonspherically distributed x make the use of a quadratic metric unnatural as a
measure of distance between treated and control units. For example, we have found in
practice that if x contains one coordinate representing a rare binary event, then
Mahalanobis metric matching may try too hard to match that coordinate exactly,
thereby reducing the quality of matches on the other coordinates of x. Propensity
matching can effectively balance rare binary variables for which it is not possible to
match treated and control units adequately on an individual basis.
3-3. Subelassification on propensity scores
A second major method of adjustment for confounding variables is subelassification,
whereby experimental and control units are divided on the basis of x into subclasses or
strata (Cochran, 1965, 1968; Cochran & Rubin, 1973). Direet adjustment with subclass
total weights can be applied to the subclass differences in response to estimate the
average treatment effect (1·1) whenever treatment assignment is strongly ignorable,
without modelling assumptions such as parallel linear response surfaces; see Corollary
4.2.
As a method of multivariate adjustment, subelassification has the advantage that it
involves direct comparisons of ostensibly comparable groups of units within each
52 P. R. ROSENBAUM AND D. B. RUBIN
subclass and therefore can be both understandable and persuasive to an audience with
limited statistical training. The comparability of units within subclasses can be verified
by the simplest methods, such as bar charts of means.
A that as the number of major problem with subclassification (Cochran, 1965) is
confounding variables increases, the number of subelasses grows dramatically, so that
even with only two categories per variable, yielding 2 subclasses for P variables, most
subclasses will not contain both treated and control units. Subelassification on the
propensity score is a natural way to avoid this problem.
We now use an estimate of the propensity score to subclassify patients in an actual
observational study of therapies for coronary artery disease. The treatments are coronary
artery bypass surgery, z = 1, and drug therapy, z = 0. The covariates x are clinical,
haemodynamie, and demographic measurements on each patient made prior to treatment assignment. Even though the covariates have quite different distributions in the
two treatment groups, within each of the five subelasses, the surgical and drug patients
will be seen to have similar sample distributions of x.
The propensity score was estimated using a logit model for z given z. Covariates and
interactions among covariates were selected for the model using a stepwise procedure.
Based on Cochran's (1968) observation that subclassification with five subclasses is
sufficient to remove at least 90% of the bias for many continuous distributions, five
subelasses of equal size were constructed at the quintiles of the sample distribution of the
propensity score, each containing 303 patients. Beginning with the subclass with the
highest propensity scores, the five subelasses contained 234 surgical patients, 164
surgical patients, 98 surgical patients, 68 surgical patients and 26 surgical patients,
repectively.
For each of the 74 covariates, Table 2 summarizes the balance before and after
sublassification. The first row describes the 74 F statistics, that is the squares of the usual
Table 2. Example of increased balance using subclassification on estimated propensity score
as summarized by distributions of F statistics for 74 covariates
Lower
Minimum quartile Median
Upper
quartile Maximum
Treatment main effect 4-0 6.8 10-9 16.8 51-8
without subelassification
Treatment main effect 0.0 0-1 0.2 0-6 3-6
with subelassification
Treatment by subelass 00 0.4 0-8 1.2 2.0
interaction
two-sample t statistics, for comparing the surgical group and drug group means of each
covariate prior to subclassification. The second and third rows describe F statistics for the
main effect of treatment and for interaction in a 2 x 5, treatments by subclasses, analysis
of variance, performed for each covariate. Although there is considerable imbalance
prior to subelassification, within the constructed subclasses there is greater balance than
would have been expected if treatments had been assigned at random within each
subclass.
When subclasses are perfectly homogeneous in b(x), Theorem 2 shows that x has the
same distribution for treated, 2 = 1, and control, z = 0, units in each subelass. Moreover,
by Corollary 4.2, if treatment assignment is strongly ignorable, then the directly
adjusted estimate with population total weights is unbiased for the average treatment
Propensity score in observational studies 53
effect (1·1). However, in this example, and generally in practice, subclasses will not be
exactly homogeneous in the balancing score b(x) that was used in subclassification, so the
directly adjusted estimate may contain some residual bias due to x.
The corollary to the following theorem shows that direct adjustment based on a
balancing score b = b(x) can be expected to reduce bias in each coordinate of providing
the adjustment reduces the bias in b.
Let I, be the set of values of a balancing score which make up subclass s (s = 1,..., S),
so that b(a) € I, implies that units with x = a fall in subelass s. Suppose the weight
applied to subclass s in direct adjustment is w.
THEOREM 7. The bías in x after direct adjustment for the subclasses (I5,8 = 1,..., S) is
B= Σ wE(x b) {pr(b|z = 1,6 € 1,) -pr (b|2 = 0, b € 1,)} db,
where b = b(x).
COROLLARY 7·1. If E(x|b) = x+Bf(b) for some vectors a and ẞ and some scalar valued
function f(.) of b, and if the subclasses are formed using b, then the subclassification is equal
per cent bias reducing in the sense that the per cent of bias in x remaining after adjustment is
the same for each coordinate ofx, namely, 100 y, where
Σ, w,ff(b) {pr (b|2 = 1, be 1)-pr (b 2 = 0, b∈ 1,)} db و] =f(b){pr(b|z= 1)-pr(b |2 = 0)} db.
where the sum is over s = 1,..., S.
Proof. Apply Theorem 7 and follow the argument of Corollary 6.1.
In parallel with Corollary 6.2 direct adjustment based on a balancing score within
subpopulations defined byx can be shown to be equal per cent bias reducing within those
subpopulations.
Subclassification on the propensity score is not the same as any of the several methods
proposed by Miettinen (1976): the propensity score is not generally a 'confounder' score.
For example, one of Miettinen's confounder scores is
pr (z = 1|r₂ = 1, x) + pr (2 = 1|x) = e(x).
Moreover, under strong ignorability,
e(x) = pr (2 = 1| x} = pr (2 = 1|r1, o, x) pr (2 = 17, = 1, x),
so strong ignorability does not convert a confounder score into the propensity score.
3:4. Propensity scores and covariance adjustment
The third standard method of adjustment in observational studies is covariance
adjustment. The point estimate of the treatment effect obtained from an analysis of
covariance adjustment for multivariate x is, in fact, equal to the estimate obtained from
54 P. R. ROSENBAUM AND D. B. RUBIN
univariate covariance adjustment for the sample linear discriminant based on x,
whenever the same sample covariance matrix is used for both the covariance adjustment
and the discriminant analysis. This fact is most easily demonstrated by linearly
transforming x to the sample discriminant and components orthogonal to the sample
discriminant which by construction have the same sample mean in both groups. Since
covariance adjustment is effectively adjustment for the linear diseriminant, plots of the
responses i and roi or residuals rkiki where fi is the value of predicted from the
regression model used in the covariance adjustment, versus the linear discriminant are
useful in identifying nonlinear or nonparallel response surfaces, as well as extrapolations,
which might distort the estimate of the average treament effect. Furthermore, such a
płot is a bivariate display of multivariate adjustment, and as such might be useful for
general presentation.
Generally, plots of responses and residuals from covariance analysis against the
propensity score e(x) are more appropriate than against the discriminant, unless of
course the covariates are multivariate normal with common covariance matrix in which
case the propensity score is a monotone function of the discriminant. The reason is that,
by Corollary 4.3, if treatment assignment is strongly ignorable, then at each e(x) the
expected difference in response E{1|z = 1,e(x}} -E{ro|z = 0, e(x)} equals the average
treatment effect at e(x), namely E{r₁[e(x)} -E{ro|e(x)}. This property holds for the
propensity score e(x) and for any balancing score b(x), but does not generally hold for
other functions of x; generally, plots against other functions of x are still confounded
by x.
Cases where covariance adjustment has been seen to perform quite poorly are precisely
those cases in which the linear discriminant is not a monotone function of the propensity
score, so that covariance adjustment is implicitly adjusting for a poor approximation to
the propensity score. In the case of univariate x, the linear discriminant is a linear
function of x, whereas the propensity score may not be a monotone function of x if the
variances of z in the treated and control groups are unequal. Intuitively, if the variance
of x in the control group is much larger than the variance in the treated group, then
individuals with the largest and smallest x values usually come from the control group.
Rubin (1973b, Tables 4 and 6, with = 1 and t as the estimator) has shown that with
nonlinear response surfaces, univariate covariance adjustment can either increase the
bias or overcorrect for bias dramatically if the variances of x in the treated and control
groups differ. Unequal variances of covariates are not uncommon in observational
studies, since the subset of units which receives a new treatment is often more
homogeneous than the general population. For example, in the observational half of the
Salk vaccine trial, the parents of second graders who volunteered for vaccination had
higher and therefore less variable educational achievement, x, than parents of control
children who were parents of all first and third graders (Meier, 1978).
In the case of multivariate normal z, Rubin (1979, Table 2) has shown that covariance
adjustment can seriously increase the expected squared bias if the covariance matrices in
treated and control groups are unequal, that is, if the discriminant is not a monotone
funetion of the propensity score. In contrast, when the covariance matrices are equal, so
that the discriminant is a monotone function of the propensity score, covariance
adjustment removes most of the expected squared bias in the cases considered by Rubin
(1979, Table 2). In summary, covariance adjustment cannot be relied upon to perform
well unless the linear discriminant is highly correlated with the propensity score.
Propensity score in observational studies 55
The authors acknowledge valuable discussions with Arthur P. Dempster, A. Philip
Dawid and Roderick J. A. Little on the subject of this paper. This work was partially
supported by the U.S. Health Resources Administration, the U.S. Environmental
Protection Ageney, the Educational Testing Service, the U.S. Army Research Office, and
the U.S. National Cancer Institute.
REFERENCES
COCHRAN, W.G. (1965). The planning of observational studies of human populations (with discussion). J. R.
Statist. Soc. A 128, 234-55.
COCHRAN, W. G. (1968). The effectiveness of adjustment by subclassification in removing bias in
observational studies. Biometrics 24, 295-313.
COCHRAN, W. G. & RUBIN, D. В. (1973). Controlling bias in observational studies: a review. Sankhya A 35,
417-46
COHN, P. F., HARRIS, P., BARRY, W., ROSATI, R. A., ROSENBAUM, P. R. & WATERNAUX, C. (1981).
Prognostic importance of anginal symptoms in angiographically defined coronary artery disease. Am. J.
Cardiol. 47, 233-7.
Cox, D. R.. (1958).The Planning of Experiments. New York: Wiley.
Cox, D. R. (1970). The Analysis of Binary Data. London: Methuen.
Cox, D. R. (1972). The analysis of multivariate binary data. Appl. Statist. 21, 113-20.
DAWID, A. Р. (1976). Properties of diagnostie data distributions. Biometrics 32, 647-58.
DAWID, A. P. (1979). Conditional independence in statistical theory (with discussion). J. R. Statist. Soc. B 41,
1-31.
DEMPSTER, A. P. (1971). An overview of multivariate data analysis. J. Mult. Anal. 1, 316-46.
FISHER, R. A. (1951). The Design of Experiments. Edinburgh: Oliver & Boyd.
HAMILTON, M. A. (1979). Choosing a parameter for 2 x 2 table or 2 x2 x2 table analysis. Am. J. Epidemiol.
109. 362-75
KEMPHORNE, O. (1952). The Design and Analysis of Experiments. New York: Wiley.
MEIER, P. (1978). The biggest public health experiment ever: The 1954 trial of the Salk poliomyelitis
vaccine. In Statistics: A Guide to the Unknown, Ed. J. M. Tanur, et al., pp. 3-15. San Francisco: Holden
Day.
MIETTINEN, O. (1976). Stratification by a multivariate confounder score. Am. J. Epidemiol. 104, 609-20.
RUBIN, D. В. (1973a). Matching to remove bias in observational studies. Biometrics 29, 159-83. Correction
(1974) 30, 728.
RUBIN, D. B. (1973b). The use of matching and regression adjustment to remove bías in observational
studies. Biometrics 29, 185-203.
RUBIN, D. B. (1974). Estimating causal effects of treatments in randomized and nonrandomized studies. J.
Ed. Psychol. 66, 688-701.
RUBIN, D. В. (1976a). Matching methods that are equal percent bias reducing: Some examples. Biometrics
32,109-20.
RUBIN, D. B. (1976b). Multivariate matching methods that are equal percent bias reducing: Maximums on
bias reduction for fixed sample sizes. Biometrics 32, 121-32.
RUBIN, D. В. (1977). Assignment to treatment group on the basis of a covariate. J. Ed. Statist. 2, 1-26.
RUBIN. D. В. (1978). Вayesian inference for causal effects: The role of randomization. Ann. Statist. 6, 34-58.
RUBIN. D. В. (1979). Using multivariate matched sampling and regression adjustment to control bias in
observational studies. J. Am. Statist. Assoc. 74, 318-28.
RUBIN. D. B. (1980a). Discussion of paper by D. Basu. J. Am. Statist. Assoc. 75, 591-3.
RUBIN. D. B. (1980b). Bías reduction using Mahalanobis metric matching. Biometrics 36, 293-8.
RUBIN. D. B. (1983). William G. Cochran's contributions to the design, analysis, and evaluation of
observational studies. In Research Work of William G. Cochran, Eds. S. Rao and J. Sedransk. New York:
Wiley. To appear.
SNEDECOR, G. W. & COCHRAN, W. G. (1980). Statistical Methads. Ames, Iowa: Iowa State University Press.
[Received March 1981. Revised October 1982]